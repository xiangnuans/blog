(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{569:function(t,s,a){"use strict";a.r(s);var e=a(2),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"egg常见问题笔记"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egg常见问题笔记"}},[t._v("#")]),t._v(" egg常见问题笔记")]),t._v(" "),s("h2",{attrs:{id:"egg日志的时区问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#egg日志的时区问题"}},[t._v("#")]),t._v(" egg日志的时区问题")]),t._v(" "),s("p",[t._v("问题：服务器中打印date时间是正常的，但是日志里的时间少了8小时\n方法：（待亲自验证）试下加 TZ 这个环境变量来启动看看。或者自定义 formatter，看下 egg-logger 源码")]),t._v(" "),s("h2",{attrs:{id:"node后台快速开发框架-typescript"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node后台快速开发框架-typescript"}},[t._v("#")]),t._v(" node后台快速开发框架（TypeScript）")]),t._v(" "),s("p",[t._v("基于egg.js后台快速开发框架，极速编码")]),t._v(" "),s("p",[t._v("码云：https://gitee.com/tjp0515/cool-admin-api\ngithub：https://github.com/apgzs/cool-admin-api\nbilibili：https://www.bilibili.com/video/av69398358")]),t._v(" "),s("h2",{attrs:{id:"定时任务多次执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定时任务多次执行"}},[t._v("#")]),t._v(" 定时任务多次执行")]),t._v(" "),s("p",[t._v("app.js 里做了一些初始化的定时任务的逻辑，没有使用官方的schedule，用的是node-cron，每次重启的时候，为啥会执行好几次呀？这个要怎么解决呢？")]),t._v(" "),s("p",[t._v("方案一：放到agent里执行\n方案二：放到schedule里，设置worker执行一次\n方案三：在应用启动前调用脚本执行")]),t._v(" "),s("h2",{attrs:{id:"ctx-ip总是拿到127-0-0-1应该怎么处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ctx-ip总是拿到127-0-0-1应该怎么处理"}},[t._v("#")]),t._v(" ctx.ip总是拿到127.0.0.1应该怎么处理")]),t._v(" "),s("p",[t._v("nginx配置")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("location "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  proxy_set_header Host $host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  proxy_set_header Upgrade $http_upgrade"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  proxy_set_header Connection "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"upgrade"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  proxy_set_header "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Real"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IP")]),t._v(" $remote_addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  proxy_set_header "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("X")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("For $proxy_add_x_forwarded_for"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  proxy_pass http"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7071")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("缺少exports.proxy = true;")])])}),[],!1,null,null,null);s.default=r.exports}}]);